<div class="app-mod-en-mass pd20" [formGroup]="modMassBalsForm">
  <div class="flex">
    <div class="totalInbox mgb30">
      <span class="val">{{ balNumber }}</span>
      {{ 'BOITES_AUX_LETTRES' | translate }}
    </div>
    <div class="info-bulle">
      <app-info-bulle
        [balDataList]="selectedBal.length > 0 ? selectedBal : balDataList"
        [selectedBal]="selectedBal"
      ></app-info-bulle>
    </div>
  </div>
  <h3>{{ 'MOD_MASS_NOTIF_CRITERIA_TITLE' | translate }}</h3>

  <!-- Select BOX  -->
  <div class="select-field field-lists flex mgt40">
    <div class="inputField" style="flex-grow: 1">
      <ng-select
        #ngselect
        [items]="TEMP_CRITERIA_LIST"
        bindLabel="label"
        bindValue="id"
        placeholder="Etat"
        name="filterField"
        class="ngselectCustom"
        (change)="SELECT_FIELD($event)"
        (focus)="ngSelectOpened = true"
      >
      </ng-select>
      <label
        for="CritÃ¨res de recherche du message"
        [ngClass]="ngSelectOpened ? 'ng-select-label' : ''"
      >
        {{ 'REMETTRE_DISPO_FILTER_1' | translate }}
      </label>
    </div>
    <button
      class="main-btn icon mgl20"
      [disabled]="!isAddItem"
      (click)="INSERT_FIELD()"
    >
      {{ 'AJOUTER_CRITERE' | translate }}
    </button>
  </div>
  <!-- fields -->
  <div class="form mbt40">
    <div class="fields-container" *ngFor="let field of TEMP_CRITERIA_LIST">
      <div *ngIf="field.disabled" class="inputField">
        <div *ngIf="field.disabled && field.type === 'list'">
          <ng-select
            [items]="
              field.fcn !== 'frontal' ? typeBALList : selectListDataNew.frontal
            "
            bindLabel="label"
            bindValue="id"
            placeholder="Etat"
            name="filterField"
            class="ngselectCustom"
            (change)="onsSelectField($event, field.fcn)"
            (focus)="onSelectFocus(field.id)"
            formControlName="{{ field.fcn }}"
          >
          </ng-select>
        </div>
        <input
          *ngIf="
            field.type === 'text' ||
            field.type === 'email' ||
            field.type === 'number'
          "
          [type]="field.type"
          maxlength="320"
          id="field.fcn"
          min="0"
          placeholder=" "
          (keyup)="onKeyUp($event, field.fcn)"
          (change)="onChange($event, field.fcn)"
          formControlName="{{ field.fcn }}"
        />
        <!-- input text -->

        <button class="remove-item-btn" (click)="REMOVE_FIELD(field)">
          <i class="zmdi zmdi-delete"></i>
        </button>
        <!-- error messages -->
        <div class="helptext text-red">
          <ng-container [ngSwitch]="field.fcn">
            <ng-template
              *ngIf="form.get('frontal').value && form.get('frontal').invalid"
              [ngSwitchCase]="'frontal'"
              >Champ oblegatoire</ng-template
            >
            <ng-template
              *ngIf="
                form.get('typeBALList').value && form.get('typeBALList').invalid
              "
              [ngSwitchCase]="'typeBALList'"
              >Champ oblegatoire</ng-template
            >
            <ng-template
              *ngIf="form.get('seuil').value && form.get('seuil').invalid"
              [ngSwitchCase]="'seuil'"
              >{{ 'INVALID_INPUT' | translate }}</ng-template
            >
            <ng-template
              *ngIf="
                form.get('listeAdressesIPAutorises').value &&
                form.get('listeAdressesIPAutorises').invalid
              "
              [ngSwitchCase]="'listeAdressesIPAutorises'"
              >{{ 'INVALID_INPUT' | translate }}</ng-template
            >
            <ng-template
              *ngIf="
                form.get('adresseMailAlerte').value &&
                form.get('adresseMailAlerte').invalid
              "
              [ngSwitchCase]="'adresseMailAlerte'"
              >{{ 'INVALID_INPUT' | translate }}</ng-template
            >
            <ng-template
              *ngIf="
                form.get('balRelais').value && form.get('balRelais').invalid
              "
              [ngSwitchCase]="'balRelais'"
              >{{ 'INVALID_INPUT' | translate }}</ng-template
            >
          </ng-container>
        </div>

        <span *ngIf="field.id === 6" class="helptext">{{
          'OPTIONAL' | translate
        }}</span>

        <label
          *ngIf="field.type === 'list' && field.fcn == 'frontal'"
          for="{{ field.label }}"
          [ngClass]="isFrontalFielled ? 'ng-select-label' : ''"
        >
          {{ field.label | translate }}
        </label>

        <label
          *ngIf="field.type === 'list' && field.fcn == 'typeBALList'"
          for="{{ field.label }}"
          [ngClass]="istypeBALListFielled ? 'ng-select-label' : ''"
        >
          {{ field.label | translate }}
        </label>

        <label
          *ngIf="!(field.id == '1' || field.fcn == 'typeBALList')"
          for="{{ field.label }}"
        >
          {{ field.label | translate }}
        </label>
      </div>
    </div>

    <div class="wrapper-btn">
      <button class="main-btn btn-reset" (click)="closeFormulaire()">
        {{ 'CANCEL' | translate }}
      </button>

      <button
        class="main-btn btn-second"
        [disabled]="!is_form_valid()"
        (click)="onSubmit()"
      >
        {{ 'VALID' | translate }}
      </button>
    </div>
  </div>
</div>
